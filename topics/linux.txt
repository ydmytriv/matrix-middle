users, groups
	groups - list all groups
	groups user - list all users of group "user"
	useradd -g cartoons spike - додати юзера spike в групу cartoons
	 /etc/group - secondary groups 
	 /etc/passwd - primary groups
	sudo useradd vasyapupkin -m - створити домашній каталог (по замовчуванню не створюється)
	sudo useradd -D -s /bin/bash - змінити параметри створення юзера (тут змінити оболонку)
	sudo usermod - редагування користувача (usermod -b /home/vasa vasapupkin)
	sudo passwd -d vasyapupkin - встановити пустий пароль
	sudo passwd -l vasyapupkin - заблокувати
	sudo passwd -u vasyapupkin - розблокувати
	
	sudo groupadd testgroup - створити групу
	
права
https://vds-admin.ru/freebsd/permissions-prava-dostupa-i-failovye-flagi-v-operatsionnykh-sistemakh-unix
SUID ( Set user ID ) - вісімкове 4000 - при запуску такого файла, процес буде мати тимчасово права власника файла (замість х в юзера стоїть "s")
SGID ( Set group ID ) - вісімкове 2000 - при запуску такого файла, процес буде мати тимчасово права групи файла (замість х в групи стоїть "s")
Stiky-bit ( липучка ) - вісімкове 1000 - якщо на папку встановлено таке, то файли в ній можна видаляти і переіменовувати тільки якщо користувач власник файла, 
папки або рут - для всіх стоїть "t"
 	1-x
 	2-w
 	4-r

 Флаги файлів і папок: (значення флагів може змінити той, хто їх поставив або root) (доступно тільки в BSD системах	)
 	мають перевагу над дозволами
 	arch  - архівний (тільки root)
 	sappnd - (тільки root) в файл можна тільки дописувати, в папці можна створювати і читати але не видаляти і переіменовувати
 		uappnd - (юрез і root) 
 	schg (root) - не можна переіменувати, змінити, видалити, для папки-не можна додавати або видаляти файли, але змінювати вміст існуюючих можна
 	# chflags schg test_file
 		uchg (юзер і root)
 	sunlnk - (root) файл не можна переіменувати і видалити (вмісь можна міняти)
 		uunlnk (юзер і root)

chattr +i /path/to/filename - встановити immutable bit - захист від зміни (встановити може тільки рут)
lsattr /path/to/filename - вивести атрибути 



Cgroups = limits how much you can use;
namespaces = limits what you can see (and therefore use)

Файлові системи
https://opencentr.ru/article/fajlovaya-sistema-linux/
https://habr.com/post/45873/
https://losst.ru/rabota-s-fajlovoj-sistemoj-linux
	ext3 - найпопулярніша (журнальована - файлові тразакції пишуться в спеціальну зону диску журнал, лог, перед тим, як дані попадуть в кінцеві точнки файлової с-ми (з журналу транзакція 
	стирається тільки після успішного виконання, при збої файлова система буде перевіряти дані, які є в журналі (незакінчені транзакції) - економія часу))
    розмір файлу до 1тб
	xfs - найстаріша журнальована файлова система
	file -s /dev/sda1 - покаже яка файлова система на даному диску
	sudo mkfs -t ext4 -L root /dev/sda6  - створити файлову систему
	sudo resize2fs /dev/sda6 400M - зменшення розміру розділу до 400 мб (М - зменшення)
	mount /dev/sda9 /dos  - примонтувати файлову систему в точку /dos
	sudo fsck -a /dev/sda6 - перевірка ф.системи (-с - перевірка битих секторів і помічення їх)

Скинути пароль рута
	- грузимось в мод 1 (натискаємо е)
	- в строці яка починається на  linux16 дописуємо init=/bin/bash і стираємо rhgb qіuet
	- ctrl+x
	- mount -n -o remount,rw /   - перемонтовуємо файлову систему
	- passwd root
	- touch /.autorelabel
	- exec /sbin/init

inode - дані про файл (розмір, ІD, групи, права, час доступу і зміни ...), але не містить його ім"я, ім"я береться з directory table, звідки береться номер inode
	 df -hTi  - перевірити к-ть inodes
	 sudo apt-get autoremove -f - може допомогти звільнити іноди (іноди не стираються поки існує хоч одна жорстка зсилка на файл або процес використовує файл)

Зміна розміру LVM
	виконується в single mode або з-під LiveCD
		lvscan - показує логічні диски
		umount /dev/VolGroup/LogVol01 - відмонтовуємо потрібний волюм
		fsck.ext4 /dev/VolGroup/LogVol01 - перевірка файлової системи
		e2fsck -f /dev/VolGroup/LogVol01 - перевірка на наявність помилок
		resize2fs -p /dev/VolGroup/LogVol01 30G - зменшення розміру файлової системи тома (30G - який розмір встановити)
		lvreduce -L 30G /dev/VolGroup/LogVol01 - змінюємо розмір тома
	в звичайному режимі:
		lvextend -l+100%FREE /dev/VolGroup/LogVol02 -r  - додає вільне місце і робить ресайз файлової системи  (-r = resize2fs /dev/VolGroup/LogVol02)

написати демон:
https://www.youtube.com/watch?v=gnC0mF0HCqM
	1. пишемо скріпт, який повинен щось робити
	2. пишемо ініціалізаційний скріпт в /etc/init.d/ (rc скрипт) (визначаємо старт, стоп, рестарт)
		вказуємо чекконфіг(на яких ранлевелах він буде працювати і з якими пріорітетами він буде запускатись і стопатись)
		вказуємо бібліотеку (. /et/init.d/functions)
		можемо через кейс створити запуск з різними аргументами
		стартуємо скріпт 1 в фоні і записуємо його pid в файл щоб можна було вбити процес
		chkconfig script2 on  - додає скріпт в автозапуск на вибраних левелах

загрузка linux
	- bios
		шукає і завантажує MBR
	- mbr
		master boot record, розміщується в першому секторі загрузочного диска (менше 512 байт)
			- головна загрузочна інформація (446 байт)
			- інфомація про таблицю розділів (64 байт)
			- 2 байти - для перевірки коректності mbr
	- grub
		Grand Unified Bootloader, якщо встановлено більше 1 ядра, то є можливість вибрати яке ядро завантажувати (або завантажить те, що по замовчуванню)
		завантажує і виконує образи ядра і initrd - Initial RAM Disk(невеликий набір модулів ядра, який лежить в запакованому вигляді поруч з ядром, може містити різні драйвери(для LVM наприклад), викор. як 
		тимчасова коренева файлова система)
	- kernel
		монтує файлову систему, виконує /sbin/init
	- init
		дивиться в файл /etc/inittab, щоб визначити runlevel і завантажує всі необхідні програми (фонові процеси у вигляді демонів)
	- runlevel
		0 – прервать выполнение
		1 – Однопользовательский режим, так называемый «Single user mode», или иными словами, консоль восстановления
		2 – Многопользовательский режим без поддержки NFS
		3 – Полноценный многопользовательский режим
		4 – не используется
		5 – X11
		6 – перезагрузка

		telinit 5 - змініти ранлевел
		runlevel - на якому левелі ми зараз

		в папці /etc/rc№.d/ є скріпти, якщо починаються з S -  то автозапуск

Nmap - набір інструментів для скануванян мережі
	nmap |опції| |ціль|
	nmap -O target.host.com - взнати яка операційка стоїть на даному хості і багато іншого
	nmap –O 10.0.0.1-42 - хости з 1 по 42
	nmap 10.0.0.1 - простканувати відкриті порти
	nmap -sV 10.0.0.1 - просканувати версії сервісів, які працюють на портах (агресивне скануання)
	nmap –sP 10.0.0.0/24 - просканує які хости онлайн в даній мережі

Strace - дозволяє відстежувати виконання заданої програми
	strace -o /tmp/strace-file  - вивід в файл
	strace -p PID - по процесу

 компілятори	
 	dpkg --list | grep compiler  - список встановлених компіляторів
 	make (викор компілятор gcc)
 		пишеться makefile, потім make "ціль"
 		make install - установка програми в систему
 		make
 			all - за замовчуванням
 			clean - очистити каталог ві всіх файлів, отриманих в результаті компіляції
 			install  - інсталяція
 			uninstall  - деінсталяція
 	gdb - компілятор

 змінні оточення
	export VAR_NAME=VAR_VALUE - глобальна змінна, яка буде існувати в рамках даного процесу
	якщо в файлі ~/.bashrc прописати export VAR_NAME=VAR_VALUE, то змінна буде доступна завжди
	для юзера:
		.BASHRC - завантажується при підклченні через термінал
		.BASH_PROFILE - при підключенні ssh або (.bash_login  .profile)
		/ETC/ENVIRONMENT - тут можна створити змінні, які будуть доступні всім
		/ETC/BASH.BASHRC - для всіх локальних користувачів
		/ETC/PROFILE - для всіх через віддалене підключення
	 env –i bash - запускає оточення без зміних
	 unset имя_переменной - видалить змінну до кінця сесії

selinux - система примусового контролю доступу, реалізована на рівні ядра
https://habr.com/company/kingservers/blog/209644/
терміни:
	Домен - список дій, які може виконувати процес
	Роль - список доменів, які можуть бути примінені
	Тип - набір дій, які можуть бути примінені до об"єкта (файли, папки, пайпи)
	режими роботи:
		1. Enforcing - блокується все, що може порушити політику і фіксується в журналі
		2. Permissive - дії не блокуються а фіксуються в журналі
		3. Disabled
	моделі керування доступом:
		1. Type Enforcement (TE): дозволяє детально керувати дозволами
		2. Role-Based Access Control (RBAC): дозволи виконувати певні дії одним елементам над іншими
		3. Multi-Level Security (MLS): всім елементам системи присвоюється відповідний рівень доступа

ulimit - дозволяє обмежувати ресурси програми
ulimit -a - вивести обмеження
Рассмотрим использование ulimit на примере ограниений пользователя game

Итак, добавим в конец /etc/profile:

if [ "$USER" = "game" ]; then

    ulimit -c 0 # Запрещаем создавать core файлы
    ulimit -d 48000 # Ограничиваем максимальный размер сегмента данных в 48 MB
    ulimit -s 8192  # Ограничиваем максимальный размер стэка в 8 MB
    ulimit -m 48000 # Ограничиваем максимальный размер резидентной части процесса (находящейся в ОЗУ) в  48 MB
    ulimit -u 64    # Ограничиваем максимальное часло запущенных этим пользователем процессов.
    ulimit -n 128   # Ограничиваем максимальное часло открытых файлов.
    ulimit -f 100000 # Ограничиваем максимальный размер создаваемого файла в 100 MB
    ulimit -v 100000 # Ограничиваем максимальный размер используемой виртуальной памяти в 100 MB
fi
